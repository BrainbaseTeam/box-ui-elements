{"version":3,"sources":["../../src/utils/createTheme.js"],"names":["Color","method","merge","mapValues","THEME_VERY_DARK","THEME_DARK","THEME_MID_DARK","THEME_MIDTONE","THEME_MID_LIGHT","THEME_VERY_LIGHT","defaultTheme","vars","OFFSET_FACTOR","MIN_CONTRAST","getYiq","color","rgb","adjustLightness","amount","lightness","createTheme","colorKey","Error","colorKeyObj","colorKeyYiq","colorKeyLightness","whiteTextContrast","contrast","white","blackTextContrast","black","foreground","foregroundObj","colorMap","yiqRange","modifiers","active","gradient","hover","activeInverse","hoverInverse","lightnessThreshold","colorRange","Object","keys","find","key","colorRangeConfig","modifiedColors","entries","value","exceedsLightThreshold","exceedsDarkThreshold","hoverContrast","activeContrast","scrollShadowRgba","colorKeyHex","hex","hoverHex","activeHex","gradientHex","colorValues","background","backgroundHover","backgroundActive","backgroundGradient","border","bdlGray10","buttonForeground","buttonBackground","bdlGray","buttonBackgroundHover","bdlGray80","buttonBackgroundActive","bdlGray62","buttonBorder","buttonBorderHover","buttonBorderActive","progressBarBackground","bdlGray50","dynamicTheme","primary","_debug"],"mappings":"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","sourcesContent":["/* eslint-disable no-restricted-syntax */\n// @flow\nimport Color from 'color';\nimport type { ColorType } from 'color';\nimport method from 'lodash/method';\nimport merge from 'lodash/merge';\nimport mapValues from 'lodash/mapValues';\n\nimport {\n    THEME_VERY_DARK,\n    THEME_DARK,\n    THEME_MID_DARK,\n    THEME_MIDTONE,\n    THEME_MID_LIGHT,\n    THEME_VERY_LIGHT,\n} from '../constants';\nimport defaultTheme from '../styles/theme';\nimport * as vars from '../styles/variables';\n\n// When converting from rgb/hsl to hex there is potential for\n// flattening of the color space, so we add an offset factor to account for it.\nconst OFFSET_FACTOR = 0.05;\nexport const MIN_CONTRAST = 4.5;\n\n// The yiq coefficients in the color library are incorrect\n// http://poynton.ca/notes/colour_and_gamma/ColorFAQ.html#RTFToC9\nfunction getYiq(color: string) {\n    const rgb = Color(color).rgb().color;\n\n    return (rgb[0] * 2126 + rgb[1] * 7152 + rgb[2] * 722) / 10000;\n}\n\nfunction adjustLightness(color: ColorType, amount: number) {\n    const lightness = color.lightness();\n    return color.lightness(lightness + amount);\n}\n\n// Given a colorKey, output an accessible Box color palette\nfunction createTheme(colorKey: string) {\n    if (!colorKey) {\n        throw new Error('Color key is undefined');\n    }\n\n    const colorKeyObj = Color(colorKey);\n    const colorKeyYiq = getYiq(colorKey);\n    const colorKeyLightness = colorKeyObj.lightness();\n\n    const whiteTextContrast = colorKeyObj.contrast(Color(vars.white));\n    const blackTextContrast = colorKeyObj.contrast(Color(vars.black));\n\n    // Take the greater contrasting foreground color\n    const foreground = whiteTextContrast > blackTextContrast ? vars.white : vars.black;\n    const foregroundObj = Color(foreground);\n\n    //  vDark dark    midDark   midtone   midLight  vLight\n    // |----|-----|-----------|----|----|-----------|----|\n    // 0    4     20         118  128  168         235  255\n    const colorMap = {\n        [THEME_VERY_DARK]: {\n            yiqRange: [0, 4],\n            modifiers: {\n                active: 15,\n                gradient: 10,\n                hover: 10,\n            },\n        },\n        [THEME_DARK]: {\n            yiqRange: [4, 20],\n            modifiers: {\n                active: 8,\n                gradient: 5,\n                hover: 4,\n            },\n        },\n        [THEME_MID_DARK]: {\n            yiqRange: [20, 118],\n            modifiers: {\n                active: -8,\n                gradient: -5,\n                hover: 4,\n            },\n        },\n        [THEME_MIDTONE]: {\n            yiqRange: [118, 168],\n            modifiers: {\n                active: -7,\n                activeInverse: 9,\n                gradient: -7,\n                hover: 7,\n                hoverInverse: -4,\n            },\n        },\n        [THEME_MID_LIGHT]: {\n            yiqRange: [168, 235],\n            modifiers: {\n                active: 15,\n                gradient: -10,\n                hover: 10,\n            },\n        },\n        [THEME_VERY_LIGHT]: {\n            yiqRange: [235, 256],\n            lightnessThreshold: 90,\n            modifiers: {\n                active: -8,\n                gradient: -5,\n                hover: -4,\n            },\n        },\n    };\n\n    // Filter down the color map to the object that's in the proper YIQ range\n    const colorRange = Object.keys(colorMap).find(\n        key =>\n            (colorKeyYiq >= colorMap[key].yiqRange[0] && colorKeyYiq < colorMap[key].yiqRange[1]) ||\n            (colorMap[key].lightnessThreshold && colorKeyLightness >= colorMap[key].lightnessThreshold),\n    );\n    const colorRangeConfig = {\n        ...colorMap[colorRange || THEME_MIDTONE],\n    };\n\n    // Modify the primary colorKey with the associated modifiers from the filtered map\n    const modifiedColors = {};\n\n    for (const [key, value] of Object.entries(colorRangeConfig.modifiers)) {\n        // $FlowFixMe\n        modifiedColors[key] = adjustLightness(colorKeyObj, value);\n    }\n\n    // If the color is too extreme on either end of the spectrum we need to change our rules.\n    const exceedsLightThreshold = colorRange === THEME_VERY_LIGHT || colorRange === THEME_MID_LIGHT;\n    const exceedsDarkThreshold = colorRange === THEME_VERY_DARK || colorRange === THEME_DARK;\n\n    // Light or dark isn't sufficient for determining how the secondary or accent colors should\n    // be calculated. In addition to that check, we will check the yiq value of the color to ensure\n    // the colorKey is not on the edges of the spectrum.\n\n    const hoverContrast = modifiedColors.hover.contrast(foregroundObj);\n    // If contrast has reached 21, we have hit the end of the spectrum and want to invert.\n    const hover =\n        hoverContrast >= MIN_CONTRAST + OFFSET_FACTOR && hoverContrast !== 21\n            ? modifiedColors.hover\n            : modifiedColors.hoverInverse || adjustLightness(colorKeyObj, -colorRangeConfig.modifiers.hover);\n\n    const activeContrast = modifiedColors.active.contrast(foregroundObj);\n    const active =\n        activeContrast >= MIN_CONTRAST + OFFSET_FACTOR && activeContrast !== 21\n            ? modifiedColors.active\n            : modifiedColors.activeInverse || adjustLightness(colorKeyObj, -colorRangeConfig.modifiers.active);\n\n    let scrollShadowRgba = 'rgba(0, 0, 0, 0.12)';\n    if (exceedsLightThreshold) {\n        scrollShadowRgba = 'rgba(0, 0, 0, 0.08)';\n    } else if (exceedsDarkThreshold) {\n        scrollShadowRgba = 'rgba(0, 0, 0, 0.4)';\n    }\n\n    // Converting color objects to hex for return value\n    const colorKeyHex = colorKeyObj.hex();\n    const hoverHex = hover.hex();\n    const activeHex = active.hex();\n    const gradientHex = modifiedColors.gradient.hex();\n\n    const colorValues = {\n        background: colorKeyHex,\n        backgroundHover: hoverHex,\n        backgroundActive: activeHex,\n        backgroundGradient: gradientHex,\n        foreground,\n        border: exceedsLightThreshold ? vars.bdlGray10 : colorKeyHex,\n\n        // Button specific overrides. If the primary color is greater than the lightness threshold\n        // we will override the button styling to be a styling based on vars.bdlGray primary.\n        buttonForeground: exceedsLightThreshold ? vars.white : foreground,\n        buttonBackground: exceedsLightThreshold ? vars.bdlGray : colorKeyHex,\n        buttonBackgroundHover: exceedsLightThreshold ? vars.bdlGray80 : hoverHex,\n        buttonBackgroundActive: exceedsLightThreshold ? vars.bdlGray62 : activeHex,\n        buttonBorder: exceedsLightThreshold ? vars.bdlGray : colorKeyHex,\n        buttonBorderHover: exceedsLightThreshold ? vars.bdlGray80 : hoverHex,\n        buttonBorderActive: exceedsLightThreshold ? vars.bdlGray62 : activeHex,\n\n        // ProgressBar overrides\n        progressBarBackground: exceedsLightThreshold ? vars.bdlGray50 : hoverHex,\n\n        // Scroll effect overrides for scrollable themed elements\n        scrollShadowRgba,\n    };\n\n    const dynamicTheme = {\n        // To avoid a mixture of casing, we force all values to lower\n        primary: { ...mapValues(colorValues, method('toLowerCase')), _debug: { colorRange } },\n    };\n\n    return merge({}, defaultTheme, dynamicTheme);\n}\n\nexport { createTheme };\n"],"file":"createTheme.js"}