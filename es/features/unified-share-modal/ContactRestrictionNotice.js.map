{"version":3,"sources":["../../../src/features/unified-share-modal/ContactRestrictionNotice.js"],"names":["React","noop","getProp","FormattedMessage","injectIntl","Tooltip","PlainButton","InlineNotice","LoadingIndicator","SingleSelectField","messages","SINGLE_CONTACT","MULTIPLE_CONTACTS","RESTRICTION_JUSTIFICATION_ENABLED","RESTRICTION_JUSTIFICATION_DISABLED","restrictionNoticeMessageMap","justifiableContactRestrictionNoticeSingular","justifiableContactRestrictionNotice","contactRestrictionNoticeSingular","contactRestrictionNotice","ContactRestrictionNotice","error","intl","isFetchingJustificationReasons","isRestrictionJustificationEnabled","justificationReasons","onRemoveRestrictedExternalContacts","onSelectJustificationReason","restrictedExternalEmails","selectedContacts","selectedJustificationReason","restrictedExternalContacts","filter","value","includes","restrictedExternalContactCount","length","firstEmail","selectedValue","isErrorTooltipShown","justificationStatus","restrictedContactCountType","removeButtonLabelMessage","justifiableContactRestrictionRemoveButtonLabel","contactRestrictionRemoveButtonLabel","restrictionNoticeMessage","justificationSelectSection","formatMessage","justificationSelectPlaceholder","count","email","displayName","defaultProps","ContactRestrictionNoticeComponent"],"mappings":"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","sourcesContent":["// @flow\n\nimport * as React from 'react';\nimport noop from 'lodash/noop';\nimport getProp from 'lodash/get';\nimport { FormattedMessage, injectIntl } from 'react-intl';\nimport type { InjectIntlProvidedProps } from 'react-intl';\n\nimport Tooltip from '../../components/tooltip';\nimport PlainButton from '../../components/plain-button';\nimport InlineNotice from '../../components/inline-notice';\nimport LoadingIndicator from '../../components/loading-indicator/LoadingIndicator';\nimport SingleSelectField from '../../components/select-field/SingleSelectField';\n\nimport messages from './messages';\n\nimport type { SelectOptionProp } from '../../components/select-field/props';\nimport type { contactType as Contact } from './flowTypes';\n\nimport './ContactRestrictionNotice.scss';\n\nconst SINGLE_CONTACT = 'singleContact';\nconst MULTIPLE_CONTACTS = 'multipleContacts';\nconst RESTRICTION_JUSTIFICATION_ENABLED = 'restrictionJustificationEnabled';\nconst RESTRICTION_JUSTIFICATION_DISABLED = 'restrictionJustificationDisabled';\n\nconst restrictionNoticeMessageMap = {\n    [RESTRICTION_JUSTIFICATION_ENABLED]: {\n        [SINGLE_CONTACT]: messages.justifiableContactRestrictionNoticeSingular,\n        [MULTIPLE_CONTACTS]: messages.justifiableContactRestrictionNotice,\n    },\n    [RESTRICTION_JUSTIFICATION_DISABLED]: {\n        [SINGLE_CONTACT]: messages.contactRestrictionNoticeSingular,\n        [MULTIPLE_CONTACTS]: messages.contactRestrictionNotice,\n    },\n};\n\ntype Props = {\n    error?: React.Node,\n    isFetchingJustificationReasons?: boolean,\n    isRestrictionJustificationEnabled?: boolean,\n    justificationReasons: Array<SelectOptionProp>,\n    onRemoveRestrictedExternalContacts: () => void,\n    onSelectJustificationReason: (justificationReasonOption: SelectOptionProp) => void,\n    restrictedExternalEmails: Array<string>,\n    selectedContacts: Array<Contact>,\n    selectedJustificationReason: ?SelectOptionProp,\n} & InjectIntlProvidedProps;\n\nconst ContactRestrictionNotice = ({\n    error,\n    intl,\n    isFetchingJustificationReasons,\n    isRestrictionJustificationEnabled,\n    justificationReasons,\n    onRemoveRestrictedExternalContacts,\n    onSelectJustificationReason,\n    restrictedExternalEmails,\n    selectedContacts,\n    selectedJustificationReason,\n}: Props) => {\n    const restrictedExternalContacts = selectedContacts.filter(({ value }) => restrictedExternalEmails.includes(value));\n    const restrictedExternalContactCount = restrictedExternalContacts.length;\n\n    if (!restrictedExternalContactCount) {\n        return null;\n    }\n\n    const firstEmail = restrictedExternalContacts[0].value;\n    const selectedValue = getProp(selectedJustificationReason, 'value', null);\n    const isErrorTooltipShown = !!error;\n\n    const justificationStatus = isRestrictionJustificationEnabled\n        ? RESTRICTION_JUSTIFICATION_ENABLED\n        : RESTRICTION_JUSTIFICATION_DISABLED;\n    const restrictedContactCountType = restrictedExternalContactCount === 1 ? SINGLE_CONTACT : MULTIPLE_CONTACTS;\n\n    const removeButtonLabelMessage = isRestrictionJustificationEnabled\n        ? messages.justifiableContactRestrictionRemoveButtonLabel\n        : messages.contactRestrictionRemoveButtonLabel;\n    const restrictionNoticeMessage = restrictionNoticeMessageMap[justificationStatus][restrictedContactCountType];\n\n    const justificationSelectSection = isFetchingJustificationReasons ? (\n        <LoadingIndicator className=\"bdl-ContactRestrictionNotice-loadingIndicator\" />\n    ) : (\n        <SingleSelectField\n            data-resin-target=\"justificationReasonsSelect\"\n            options={justificationReasons}\n            onChange={onSelectJustificationReason}\n            placeholder={intl.formatMessage(messages.justificationSelectPlaceholder)}\n            selectedValue={selectedValue}\n        />\n    );\n\n    return (\n        <Tooltip text={error} isShown={isErrorTooltipShown} position=\"middle-right\" theme=\"error\">\n            <InlineNotice\n                className=\"bdl-ContactRestrictionNotice\"\n                data-resin-component=\"contactRestrictionNotice\"\n                type=\"error\"\n            >\n                <FormattedMessage\n                    {...restrictionNoticeMessage}\n                    values={{ count: restrictedExternalContactCount, email: firstEmail }}\n                />\n                &nbsp;\n                {isRestrictionJustificationEnabled && justificationSelectSection}\n                <PlainButton\n                    className=\"bdl-ContactRestrictionNotice-removeBtn\"\n                    data-resin-target=\"removeBtn\"\n                    onClick={onRemoveRestrictedExternalContacts}\n                >\n                    <FormattedMessage\n                        {...removeButtonLabelMessage}\n                        values={{ count: restrictedExternalContactCount }}\n                    />\n                </PlainButton>\n            </InlineNotice>\n        </Tooltip>\n    );\n};\n\nContactRestrictionNotice.displayName = 'ContactRestrictionNotice';\n\nContactRestrictionNotice.defaultProps = {\n    justificationReasons: [],\n    onRemoveRestrictedExternalContacts: noop,\n    onSelectJustificationReason: noop,\n};\n\nexport { ContactRestrictionNotice as ContactRestrictionNoticeComponent };\nexport default injectIntl(ContactRestrictionNotice);\n"],"file":"ContactRestrictionNotice.js"}