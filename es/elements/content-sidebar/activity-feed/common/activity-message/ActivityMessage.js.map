{"version":3,"sources":["../../../../../../src/elements/content-sidebar/activity-feed/common/activity-message/ActivityMessage.js"],"names":["React","noop","LoadingIndicator","formatTaggedMessage","ShowOriginalButton","TranslateButton","ActivityMessage","isLoading","isTranslation","event","props","id","tagged_message","onTranslate","translatedTaggedMessage","setState","preventDefault","prevProps","translationFailed","prevTaggedMessage","prevTranslationFailed","button","handleShowOriginal","handleTranslate","translationEnabled","getUserProfileUrl","state","commentToDisplay","getButton","Component"],"mappings":"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","sourcesContent":["// @flow\nimport * as React from 'react';\nimport noop from 'lodash/noop';\nimport LoadingIndicator from '../../../../../components/loading-indicator';\nimport formatTaggedMessage from '../../utils/formatTaggedMessage';\nimport ShowOriginalButton from './ShowOriginalButton';\nimport TranslateButton from './TranslateButton';\nimport type { GetProfileUrlCallback } from '../../../../common/flowTypes';\nimport './ActivityMessage.scss';\n\ntype Props = {\n    getUserProfileUrl?: GetProfileUrlCallback,\n    id: string,\n    onTranslate?: Function,\n    tagged_message: string,\n    translatedTaggedMessage?: string,\n    translationEnabled?: boolean,\n    translationFailed?: ?boolean,\n};\n\ntype State = {\n    isLoading?: boolean,\n    isTranslation?: boolean,\n};\n\nclass ActivityMessage extends React.Component<Props, State> {\n    static defaultProps = {\n        translationEnabled: false,\n    };\n\n    state = {\n        isLoading: false,\n        isTranslation: false,\n    };\n\n    componentDidUpdate(prevProps: Props): void {\n        const { translatedTaggedMessage, translationFailed } = this.props;\n        const { translatedTaggedMessage: prevTaggedMessage, translationFailed: prevTranslationFailed } = prevProps;\n\n        if (prevTaggedMessage === translatedTaggedMessage || prevTranslationFailed === translationFailed) {\n            return;\n        }\n\n        if (translatedTaggedMessage || translationFailed) {\n            this.setState({ isLoading: false });\n        }\n    }\n\n    getButton(isTranslation?: boolean): React.Node {\n        let button = null;\n        if (isTranslation) {\n            button = <ShowOriginalButton handleShowOriginal={this.handleShowOriginal} />;\n        } else {\n            button = <TranslateButton handleTranslate={this.handleTranslate} />;\n        }\n\n        return button;\n    }\n\n    handleTranslate = (event: SyntheticMouseEvent<>): void => {\n        const { id, tagged_message, onTranslate = noop, translatedTaggedMessage } = this.props;\n        if (!translatedTaggedMessage) {\n            this.setState({ isLoading: true });\n            onTranslate({ id, tagged_message });\n        }\n\n        this.setState({ isTranslation: true });\n        event.preventDefault();\n    };\n\n    handleShowOriginal = (event: SyntheticMouseEvent<>): void => {\n        this.setState({ isTranslation: false });\n        event.preventDefault();\n    };\n\n    render(): React.Node {\n        const { id, tagged_message, translatedTaggedMessage, translationEnabled, getUserProfileUrl } = this.props;\n        const { isLoading, isTranslation } = this.state;\n        const commentToDisplay =\n            translationEnabled && isTranslation && translatedTaggedMessage ? translatedTaggedMessage : tagged_message;\n        return isLoading ? (\n            <div className=\"bcs-ActivityMessageLoading\">\n                <LoadingIndicator size=\"small\" />\n            </div>\n        ) : (\n            <div className=\"bcs-ActivityMessage\">\n                {formatTaggedMessage(commentToDisplay, id, false, getUserProfileUrl)}\n                {translationEnabled ? this.getButton(isTranslation) : null}\n            </div>\n        );\n    }\n}\n\nexport default ActivityMessage;\n"],"file":"ActivityMessage.js"}